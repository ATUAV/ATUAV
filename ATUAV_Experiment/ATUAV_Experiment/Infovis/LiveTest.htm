<html>
<head>
    <script type="text/javascript" src="http://github.com/mbostock/d3/raw/v1.8.2/d3.js"></script>
    <script type="text/javascript" src="http://mbostock.github.com/d3/d3.js?2.1.3"></script>
    <script type="text/javascript" src="raphael.js"></script>
    <script src="http://code.jquery.com/jquery.min.js" type="text/javascript"></script>
    <title>Ajax example</title> 
  </head>
  <body>

  <script src="multiBars.js"></script>

	<style>
		text {
		font-size: 1em;
		font-family: Helvetica, Arial, Sans-Serif;
		}
	</style>
	
	<p>Basic Interventions</p>
	<button type="button" onclick="triggerA1()">TriggerA1</button>
	<button type="button" onclick="triggerA2()">TriggerA2</button>
	<button type="button" onclick="triggerB1()">TriggerB1</button>
	<button type="button" onclick="triggerC1()">TriggerC1</button>
	<button type="button" onclick="triggerD1()">TriggerD1</button>

	<p>Multiple Compare Interventions</p>
    <p>
	<button type="button" onclick="triggerE1()">TriggerE1</button>
	<button type="button" onclick="triggerE2()">TriggerE2</button>
	<button type="button" onclick="triggerE3()">TriggerE3</button>
	<button type="button" onclick="triggerF1()">TriggerF1</button>
	<button type="button" onclick="triggerG1()">TriggerG1</button>
	<button type="button" onclick="triggerH1()">TriggerH1</button>
	<button type="button" onclick="trigger()">Trigger Test</button>
	<button type="button" onclick="stopBlinking()">Stop Blinking</button>
	
    <div><br /><b>Live Statistics</b><br /></div>

    <div id='results'></div>
	
    <script type="text/javascript">

        function pollInterventionFile(address) {
            //getting the data from the file
            $.getJSON(address, function (data) {
                //converting the file into javascript objects
                var results = eval(data)
                var intervention = results.intervention
                var selectionGroup = results.selectionGroup
                //looping through the selectionGroup and creating a long string
                var text = "intervention: " + intervention + "<br />";
                for (i = 0; i < selectionGroup.length; i++) {
                    text += "seriesID: " + selectionGroup[i][0] + ", sampleID: " + selectionGroup[i][1] + "<br />";
                }
                //replace the text in the 'results' div with the contents of 'text'
                $("#results").html(text);
            });
        }

        function pollRawEMDATOutput(address) {
            $.getJSON(address + "?callback=?", null, function (data) {

                var value_string = "";

                for (var key in data) {
                    if (data.hasOwnProperty(key)) {
                        value_string += (key + ":" + data[key] + "</br>");
                    }
                }

                $("#results").html(value_string);
            });
        }

        //poll two sets of files in different time intervals
        //setInterval(function () { pollInterventionFile("ajax_example.json"); }, 4000);
        //setInterval(function () { pollInterventionFile("ajax_example2.json"); }, 7000);
        setInterval(function () { pollRawEMDATOutput("http://localhost:8080/atuav/intervention"); }, 5000);
    </script>
</body>
</html>
